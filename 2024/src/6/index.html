<html>
  <body>
    <div>
      <table id="table"></table>

      <button id="exercise1">Exercise 1</button>
    </div>
  </body>

  <script>
    const mockData = `
    .........#...#................................#.........#............#.....#....#.....................................#...........
    ............................................................................................#...............#.......#.............
    ....#.......#......................................#.........................#..#....#....#.........#.............................
    ............##..#............#........................#........#........#.......#...........................#................#....
    ..................................#.............#....#..........................#................#..#....##........#..............
    ..................##.#...#....#...................##.....#.................#......##.....................##............#..........
    ..........#..................................#....................................................................................
    ......#...........#.......................................#........#........................#........#............................
    ..................#................................#........................#.............................#.......................
    .............#............................................................................................##.................#....
    ........#..............................................................................................#..............#.#.......#.
    ..#...........#..............#..............#..#.....#.......#......#.......................#....#...................##..........#
    ..............##................................#..............##....................#...#........................................
    ......................#.................#.......#.......##.##....................................#................................
    ...........#...#.#..................#...#.....................................................................#...................
    .....#....#...#..............................................................................................#.......#............
    ...............................#...........#.#.............#.........#.....................................#.#....................
    ........#...........#.......#............................#.....#.............................#.........................#..........
    ...................................................#...........#.....#..#....#.............#.....#..#..#.............#............
    ..............#.........#..#..........#.#.......................#...................................#.............................
    ..#.............#..#..#.#...........#...................................................#...........................#...........#.
    ........##....##..........................................................................#.......................................
    .......................................................#.......#.............................#...................#........#.......
    #.....#.#......#...............................................................#..........#........#..............................
    .#.#............#..............#..........................#.#.....................................................#...............
    .................#...#........#....#.....#...#...................................#....#.................#..........#...#.#...#....
    ...#..##........................#..#..................................................................................#.......#...
    .................#...#.#..................................................#..#........#.................#...................#.....
    .......................#.......#....................#......................................#...............................#......
    ...............................................................................................................................#..
    ...........##............................#....................#...................................................................
    ..#........................................#..#.............................#............................#........................
    ..#.#....#..................................#...................................................................................#.
    .................#...#...............#..........#..............................#...#..............................#.#..#..........
    ............#..........#..........#...................................#.....#....................#................##.............#
    ....#...........#.......#......................................#........................................#........#......#...#.....
    .............#.....#...................#....#.....................................................................................
    .....................#.................................#.#...................#.......#.#...............#..........................
    ........#..............#.......#.............#...........................................................#........#..............#
    ............#............................................#.......##................#..............................................
    ...............................#..................................................................................................
    #....................#......#.......................#..........#.........................#................#...............#..#...#
    ..................................................#.....#...........#...#..#......#...........................#...................
    ............#......................#.....#.........#....................................................................#....#....
    .......#...................#...#...........................#.......#......#......................................#.....#..........
    .................................................#.............#....................................#.............................
    ......#.................#.............................................................................#..##.......................
    ....#..............................................#..............#..........#.......#....#............................#..........
    ........#....#............#....#.................#........................................................#.....#.................
    ..#......................#.......................................................#................................................
    .#.....................#..........................................................#.............................#.................
    .............#..............#.#.....#.........................................#...............................#.........#.........
    .............................................................................#............................#....#...#..............
    #.#.#...................................................................#...........................................#.........#...
    ..................................................#.#............#..#...#..............#.....#....................................
    ......#..................................#............................##.........................................#................
    ..#....................................#............#.........#.........#...........#.....#..............................#........
    ......................................#.............#..................#.................#..........................##............
    ...............#.#........#.......................#..........#...............................#.............................#.#....
    .................#....................................................................................#...........................
    #...............................................#.#........#...#...................#............#.................#......#.#......
    ................#........................#......#.............................................#.#..............#....#.............
    .......#..........#..........................#......#.............................................................................
    ....#.......#.................................................#..............#...........#.....#............#............#........
    .....................#...................................#...............................................................#........
    #..........................#..#...........................................#...............#............#............#.............
    .............................#...................................#...#.......................................#......#.............
    ............#........#.................................................#.................#...................#....................
    .........................................#................#.....................................#.................................
    ...........................................................................................#.....................#................
    .....................#.........#..#.#......................................................#........#.............................
    ..#......#.........#.#...................................................#......................#.................................
    .#...........#.........................................................................................#.....................#....
    ..........#....##.#..#..........#........#.#.................................#.....................#..............................
    .....#........#.......#....#...........#...................#...............#..#....#..............................#..............#
    .......#..............................#............#.................................................#........#................#..
    ...............................#..............................................#...................................................
    #..............................................................#.........................................................#........
    .......#....................................................#..............................#..................#..........##.......
    .......................................#...............................................^.............#............................
    ..#...........#.........#............................#...................................#.#.......###.....#......................
    ........#............................................................................................................#............
    ...#...#...........#.................................................................#...#.......#........#.......................
    ...............#.....................................#..........#.......#.#.....#.#..................#............................
    .....#..#..............#.#.......................#.................................................................#..............
    #.....#.........................................#..##....#..........................#...................#..#......#........#......
    ...................##................#..#......................................#.....#............................................
    ....#...............................................................................................#...........................#.
    ....#..........#....#........................#....................................................................................
    ..................#.....................................................#.....................................#...................
    ...........................#......#.......................................................................#..............#........
    ...............#....................#...#...#.......#................#.......#.......#............................................
    #.....##......#.............................................#...#.................................#.................#....#..##..#.
    ..........#.......................................#..................................#...#....#......................#............
    ......#................#.#........#....#......##.........#........................................#...............................
    ......#...#............#...#.........................................................#....#.....#..............#..................
    .........................#...............#........#...#......#....................................................#..#.#..........
    ...##............#........#.#.........................#.............................#............#..............#.................
    .......#.........#..............................#...................................#.......................#.#...................
    #..........#.............#..............................................#.....................................................#...
    ........#..#...#.....................................#............................................................................
    ..................#...............................#..........................................#.............#..............#..#....
    ....#.#..#...#............................#..............#...#..........#......#....#.....................#..........#......#.....
    ................#..............#........................#......#..............#.......................##..........................
    ..........#.....#.............................................#.......#...........................................#...............
    .........#....#........#............#...............#.............................................................................
    ...........#..#..........#..............#..........#......#.......................................................................
    ..........#....................#........................................#.....#..................#..#.#..#...#.....#..............
    ........#...........#...#..................##.........#......................#...#............#......................#............
    ...................................................#........................#.....#.............#.................................
    ........#................#..........................#.#...#......#........................................#.......................
    .............#.........................................##....................#...................#.#..................#...........
    ..................#.............................................#...............................................................#.
    .....#............#................#..............................#...##....#...#.................................................
    #.......................###........#..............#.....#.............#...............#.............#......................#......
    ...........#.............................#........................#.........................................................#.....
    ............#.....#.....#...#....#........#...............................#.....................#..................#....#.........
    ...............#.#..................................#.................#.#......#...........#...#................#.................
    .....#............................................#.....#...............#.....#.............#.......#..........#..................
    .....................................#................................................#.........#..#..............................
    .....................#...............................................#.#...........#........#.....................................
    .............................................#....................#.............#......................#..........................
    ......................................#.........#.........................##........#................#...............#............
    ........................#.....#.....................................#....#........#......#..............#.......##...........#.#..
    ....................#........................................#.........#.........#......#....#............#...........#...........
    ...........##......#...........#................#.......##.....#........#.........#...........................................#...
    ...................#...#....#.............#..#......................................................#............#................
    ....#.........................#....#..................#..............#.............#...................................#..........
    ..................................#.......#.....................#.................................................................
    .............................................#......#.......................................................#.....................`;

    const parse = (text) => text.split(/\n/).map((i) => i.split(""));

    const parsedData = parse(mockData);

    // create grid
    for (let i = 0; i < parsedData.length; i++) {
      const newRow = document.createElement("tr");
      for (let j = 0; j < parsedData[i].length; j++) {
        const id = JSON.stringify({ x: j, y: i });
        const newCell = document.createElement("td");
        const content = parsedData[i][j];
        if (content === "#") {
          newCell.textContent = "❌";
        }

        if (content === "^") newCell.textContent = "💂";

        if (content === ".") {
          newCell.textContent = "⬜️";
        }
        newCell.id = id;

        newRow.appendChild(newCell);
      }

      document.getElementById("table").appendChild(newRow);
    }

    const dirs = {
      "^": ">",
      ">": "v",
      v: "<",
      "<": "^",
    };

    const moves = {
      "^": { x: 0, y: -1 },
      ">": { x: 1, y: 0 },
      v: { x: 0, y: 1 },
      "<": { x: -1, y: 0 },
    };
    const getGuardPoint = (data, dir) => {
      let x = 0;
      let y = 0;

      data.forEach((line, yIndex) => {
        if (line.includes(dir)) {
          x = line.findIndex((i) => i === dir);
          y = yIndex;
        }
      });

      return [x, y];
    };

    const moveGuard = (data, dir, [x, y], visitedPoints) => {
      const move = moves[dir];
      let nextX = x;
      let nextY = y;

      let moving = true;
      let inBoundary = true;

      while (moving && inBoundary) {
        const id = JSON.stringify({ x: nextX, y: nextY });
        document.getElementById(id).textContent = "🟨";

        visitedPoints.add(JSON.stringify({ x: nextX, y: nextY }));

        nextX += move.x;
        nextY += move.y;

        if (
          nextX === -1 ||
          nextX === data[0].length ||
          nextY === -1 ||
          nextY === data.length
        ) {
          inBoundary = false;
          break;
        }

        const nextPoint = data[nextY][nextX];
        if (nextPoint === "#") {
          nextX -= move.x;
          nextY -= move.y;
          moving = false;
          break;
        }
      }

      if (!inBoundary) {
        return visitedPoints;
      }

      return moveGuard(data, dirs[dir], [nextX, nextY], visitedPoints);
    };

    const exercise = () => {
      const startPoint = getGuardPoint(parsedData, "^");
      const visitedPoints = moveGuard(parsedData, "^", startPoint, new Set());

      console.log(visitedPoints.size);
    };

    document.getElementById("exercise1").addEventListener("click", exercise);
  </script>
</html>
